sequenceDiagram
    participant Client
    participant Controller as NotificationController
    participant EmailService as EmailService
    participant OtpService as OtpService
    participant Redis as Redis
    participant Gmail as Gmail SMTP

    Note over Client, Gmail: Password Reset OTP Flow
    Client->>Controller: POST /password-reset/otp (Email)
    Controller->>OtpService: generateOtp(Email)
    OtpService->>Redis: GET OTP_LIMIT:{Email}
    alt Count < 5
        OtpService->>Redis: SET OTP:{Email} (5 min exp)
        OtpService->>Redis: INCR OTP_LIMIT:{Email} (30 min exp)
        OtpService-->>Controller: 6-digit OTP
        Controller->>EmailService: sendHtmlEmail(OTP Template)
        EmailService->>Gmail: Send MimeMessage
        Controller-->>Client: 200 OK (OTP Sent)
    else Count >= 5
        OtpService-->>Controller: Rate Limit Exception
        Controller-->>Client: 500 Internal Server Error (Limit Exceeded)
    end

    Note over Client, Gmail: Alert Notification Flow
    Client->>Controller: POST /send-alert (EmailRequest)
    Controller->>EmailService: sendHtmlEmail(Alert Template)
    EmailService->>Gmail: Send MimeMessage
    Controller-->>Client: 200 OK (Alert Sent)
